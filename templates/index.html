<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>ML Visionário | André TI</title>
    <style>
        :root { --bg: #050505; --card: #111; --accent: #8e44ad; --text: #ddd; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding: 40px; }
        .container { max-width: 900px; margin: auto; }
        .ml-card { 
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: 1px solid #333; border-left: 5px solid var(--accent);
            padding: 30px; border-radius: 12px; margin-bottom: 20px;
        }
        .ia-status { color: var(--accent); font-weight: bold; letter-spacing: 2px; font-size: 0.8rem; }
        .valor-previsao { font-size: 3rem; margin: 15px 0; font-weight: 800; color: #fff; }
        .insight-box { 
            background: #1a1121; border-radius: 8px; padding: 20px; 
            font-style: italic; border-left: 3px solid var(--accent); line-height: 1.6;
        }
        .btn-refresh { 
            background: transparent; border: 1px solid var(--accent); color: var(--accent);
            padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: 0.3s;
        }
        .btn-refresh:hover { background: var(--accent); color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="ml-card">
            <div class="ia-status">● ENGINE DE PREDIÇÃO ATIVO</div>
            <p>Expectativa de Lucro Próximo Período:</p>
            <div class="valor-previsao" id="previsao">R$ 0,00</div>
            
            <div class="insight-box">
                <strong>Veredito do Consultor Sênior (Gemini):</strong><br>
                <span id="insight">Analisando dados...</span>
            </div>
            <br>
            <button class="btn-refresh" onclick="carregarML()">Recalcular Insights</button>
        </div>
    </div>

    <script>
        async function carregarML() {
            const btn = document.querySelector('.btn-refresh');
            btn.innerText = "Processando ML...";
            try {
                const res = await fetch('/api/ml_insights');
                const data = await res.json();
                
                document.getElementById('previsao').innerText = data.previsao.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
                document.getElementById('insight').innerText = data.insight;
            } catch (e) {
                document.getElementById('insight').innerText = "Erro ao conectar com a API.";
            } finally {
                btn.innerText = "Recalcular Insights";
            }
        }
        carregarML();
    </script>
</body>
</html>
